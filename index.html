<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeatherWise - Yeovil Forecast & More</title>
    <!-- Link Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* css/styles.css START */
        :root {
            --primary-color: #3498db; 
            --secondary-color: #2ecc71; 
            --dark-color: #2c3e50;    
            --light-color: #f4f6f7;   
            --surface-color: #ffffff; 
            --accent-color: #5dade2;  
            --border-color: #e0e0e0;
            --text-color-base: #2c3e50; 
            --text-muted-base: #7f8c8d; 
            
            --border-radius-md: 8px;
            --border-radius-lg: 12px;

            --padding-xl: 40px;
            --padding-lg: 24px;
            --padding-md: 16px;
            --padding-sm: 12px;

            --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: var(--font-family);
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--light-color);
            color: var(--text-color-base);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--padding-md);
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            padding: var(--padding-sm) 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px; 
        }

        .logo {
            font-size: 26px;
            font-weight: 700;
            display: flex;
            align-items: center;
            transition: transform 0.3s ease; 
        }
        .logo:hover {
            transform: scale(1.05); 
        }
        .logo i {
            margin-right: 10px;
            font-size: 28px;
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55); 
        }
        .logo:hover i {
            transform: rotate(15deg) scale(1.1); 
        }

        nav ul {
            display: flex;
            list-style: none;
            align-items: center; 
        }
        nav ul li {
            margin-left: 20px; 
        }
        nav ul li:last-child { 
            margin-left: 15px;
        }
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease, opacity 0.3s ease; 
            position: relative;
            padding: 5px 0; 
        }
        nav ul li a:hover {
            opacity: 0.8;
            color: var(--light-color); 
        }
        nav ul li a::after { 
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            background: var(--light-color); 
            opacity: 0.8;
            bottom: 0; 
            left: 50%;
            transform: translateX(-50%);
            transition: width 0.3s ease;
        }
        nav ul li a:hover::after {
            width: 100%;
        }

        /* Unit Toggle Button Styling */
        .unit-toggle-btn {
            background-color: rgba(255, 255, 255, 0.2); 
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.5);
            padding: 6px 12px;
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: background-color 0.2s ease, transform 0.2s ease;
            min-width: 50px; 
            text-align: center;
        }
        .unit-toggle-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        .unit-toggle-btn:active {
            transform: scale(0.98);
        }


        /* Hero Section (Parallax styles included) */
        .hero {
            padding: 120px 0 80px; 
            background-image: url('https://images.unsplash.com/photo-1428592953211-077101b2021b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1974&q=80'); 
            background-color: var(--dark-color); 
            background-size: cover;
            background-position: center center; 
            background-repeat: no-repeat;
            position: relative; 
            color: white;
            text-align: center;
            margin-top: 60px; 
            overflow: hidden; 
        }
        .hero::before { 
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(44, 62, 80, 0.5); 
            z-index: 0; 
        }
        .hero-content {
            position: relative; 
            z-index: 1;      
            max-width: 700px; 
            margin: 0 auto;
        }
        .hero h1 {
            font-size: 38px;
            margin-bottom: var(--padding-md);
            animation: fadeIn 1s ease-in;
            font-weight: 600;
        }
        .hero p.tagline {
            font-size: 17px;
            margin-bottom: var(--padding-lg);
            animation: fadeIn 1s ease-in 0.3s both;
            opacity: 0.9;
        }

        .search-form-wrapper {
            max-width: 600px;
            margin: 0 auto;
            animation: fadeIn 1s ease-in 0.6s both;
            display: flex; 
            flex-direction: column; 
            align-items: center; 
        }
        .search-form-container {
            display: flex;
            border-radius: 30px; 
            overflow: hidden; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            width: 100%; 
            max-width: 500px; 
        }
        #locationInput {
            flex-grow: 1;
            padding: 15px 20px;
            font-size: 16px;
            border: 1px solid var(--border-color);
            border-right: none; 
            border-top-left-radius: 30px;
            border-bottom-left-radius: 30px;
            outline: none;
            color: var(--text-color-base);
            background-color: var(--surface-color);
            transition: box-shadow 0.3s ease; 
        }
        #locationInput:focus {
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
        }
        #searchButton { 
            background-color: var(--secondary-color);
            color: white;
            padding: 15px 30px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            border-top-right-radius: 30px;
            border-bottom-right-radius: 30px;
            transition: background-color 0.3s ease, transform 0.2s ease; 
            display: flex; 
            align-items: center;
            gap: 8px; 
        }
        #searchButton:hover {
            background-color: #27ae60; 
            transform: scale(1.02);
        }
        #searchButton:active {
            transform: scale(0.98);
        }
        #searchButton i { 
            transition: transform 0.3s ease;
        }
        #searchButton:hover i {
            transform: translateX(3px) scale(1.1); 
        }

        .search-input-error {
            color: #f1c40f; 
            font-size: 0.9rem;
            margin-top: 8px; 
            height: 1.2em; 
            line-height: 1.2em;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            font-weight: 500;
            text-shadow: 0px 0px 1px rgba(0, 0, 0, 0.2); 
            width: 100%; 
            max-width: 500px; 
        }
        .search-input-error.visible {
            opacity: 1;
        }

        /* Geolocation Button Styling */
        .geolocation-btn {
            background-color: transparent; 
            color: white; 
            border: 1px solid rgba(255, 255, 255, 0.7); 
            padding: 10px 20px;
            border-radius: 25px; 
            cursor: pointer;
            font-weight: 500;
            font-size: 0.95rem;
            margin-top: var(--padding-md); 
            display: inline-flex; 
            align-items: center;
            gap: 8px; 
            transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
        }
        .geolocation-btn:hover {
            background-color: rgba(255, 255, 255, 0.15); 
            transform: scale(1.03);
        }
        .geolocation-btn:active {
            transform: scale(0.99);
            background-color: rgba(255, 255, 255, 0.1);
        }
        .geolocation-btn i {
            font-size: 1rem; 
        }
        .geolocation-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        .geolocation-btn .fa-spinner { 
            margin-right: 5px;
        }


        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Loader (Spinner) Styles */
        .loader-container { 
            display: flex;
            justify-content: center;
            align-items: center;
            padding: var(--padding-xl) 0; 
            width: 100%;
            grid-column: 1 / -1; 
        }
        .loader {
            border: 6px solid var(--light-color); 
            border-top: 6px solid var(--primary-color); 
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Weather Results Section */
        .weather-results-area {
            padding: var(--padding-xl) 0; /* Adjusted to var(--padding-xl) from var(--padding-lg) in single file */
            background-color: var(--light-color); 
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            visibility: hidden; 
        }
        .weather-results-area.visible { 
            opacity: 1;
            transform: translateY(0);
            visibility: visible;
        }

        .section-title { 
            text-align: center;
            margin-bottom: var(--padding-lg);
        }
        .section-title h2 { /* Used for 10-day forecast header */
            font-size: 1.8rem; /* Adjusted from 32px for consistency with professional look */
            color: var(--dark-color);
            position: relative;
            display: inline-block;
            padding-bottom: 10px;
            font-weight: 600;
        }
         /* Removed ::after for .section-title h2 to match professional look which had it on #locationHeader only */

        #locationHeader h2 { /* Specific styling for Location Name Header */
            font-size: 2rem; /* Larger for location name */
            color: var(--primary-color);
            margin-bottom: var(--padding-lg);
            font-weight: 600;
            /* No ::after here, if desired add specific class or target */
        }


        /* Current Weather Card Styling */
        #currentWeatherCard {
            background-color: var(--surface-color);
            padding: var(--padding-lg);
            border-radius: var(--border-radius-lg);
            box-shadow: 0 8px 25px rgba(44, 62, 80, 0.1);
            margin-bottom: var(--padding-xl);
            display: grid;
            grid-template-columns: auto 1fr; 
            gap: var(--padding-lg);
            align-items: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden; 
        }
        #currentWeatherCard:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(44, 62, 80, 0.15);
        }
        #currentWeatherCard .weather-icon-temp,
        #currentWeatherCard .current-details-grid {
            opacity: 0;
            transform: translateY(15px);
            transition: opacity 0.5s ease-out 0.2s, transform 0.5s ease-out 0.2s; 
        }
        #currentWeatherCard.content-visible .weather-icon-temp,
        #currentWeatherCard.content-visible .current-details-grid {
            opacity: 1;
            transform: translateY(0);
        }
        #currentWeatherCard .weather-icon-temp {
            text-align: center;
            display: flex; /* For better alignment of icon and temp/condition stack */
            flex-direction: column; /* Default stack */
            align-items: center;
        }
         #currentWeatherCard .temp-condition-stack { /* Container for temp and condition */
            text-align: center; /* Center text below icon */
        }

        @media (min-width: 500px) { /* Side-by-side on wider screens */
            #currentWeatherCard .weather-icon-temp {
                flex-direction: row;
                text-align: left;
                gap: var(--padding-md);
            }
            #currentWeatherCard .temp-condition-stack {
                 text-align: left;
            }
        }


        #currentWeatherCard img.current-icon {
            width: 80px;  /* Adjusted size */
            height: 80px; /* Adjusted size */
            margin-bottom: var(--padding-xs);
            transition: transform 0.3s ease;
        }
         @media (min-width: 500px) {
            #currentWeatherCard img.current-icon {
                width: 100px; 
                height: 100px;
                margin-bottom: 0;
            }
        }

        #currentWeatherCard:hover img.current-icon { 
            transform: scale(1.05);
        }
        #currentWeatherCard .current-temperature {
            font-size: 3rem; /* Adjusted size */
            font-weight: bold;
            color: var(--text-color-base);
            line-height: 1;
        }
        #currentWeatherCard .current-temperature sup {
            font-size: 1.5rem;
        }
        #currentWeatherCard .current-condition {
            font-size: 1.1rem; /* Adjusted size */
            color: var(--primary-color);
            font-weight: 500;
            text-transform: capitalize;
            margin-top: 5px; /* Adjusted margin */
        }
        .current-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(170px, 1fr)); /* Adjusted minmax */
            gap: var(--padding-md); /* Adjusted gap */
        }
        .current-details-grid p {
            font-size: 0.9rem; /* Adjusted size */
            color: var(--text-muted-base); 
            background-color: var(--light-color); 
            padding: var(--padding-sm);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--border-color);
            transition: background-color 0.2s ease, box-shadow 0.2s ease; 
        }
        .current-details-grid p:hover { 
            background-color: var(--surface-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
        }
        .current-details-grid p strong {
            color: var(--text-color-base);
            font-weight: 500;
            margin-right: 5px;
        }

        /* Hourly Forecast Section Styles */
        .section-subtitle { /* For "Today's Hourly Forecast" */
            font-size: 1.4rem; /* Adjusted */
            color: var(--primary-color);
            text-align: center;
            margin-bottom: var(--padding-md);
            font-weight: 600; /* Bolder */
        }
        .hourly-forecast-section {
            margin-top: var(--padding-lg); /* Adjusted margin */
            margin-bottom: var(--padding-lg); /* Adjusted margin */
            /* Removed card like bg, now it's just a title above container */
        }
        .hourly-forecast-container {
            display: flex; 
            overflow-x: auto; 
            overflow-y: hidden; 
            padding: var(--padding-sm) 2px var(--padding-md) 2px; /* padding for scrollbar */
            gap: var(--padding-md); 
            white-space: nowrap; 
            scrollbar-width: thin; 
            scrollbar-color: var(--accent-color) var(--light-color); 
            background-color: var(--surface-color); /* Container has bg now */
            border-radius: var(--border-radius-lg);
            box-shadow: 0 5px 15px rgba(44, 62, 80, 0.08);
            margin-top: var(--padding-sm);
        }
        .hourly-forecast-container::-webkit-scrollbar { height: 8px; }
        .hourly-forecast-container::-webkit-scrollbar-track { background: var(--light-color); border-radius: 4px; }
        .hourly-forecast-container::-webkit-scrollbar-thumb { background-color: var(--accent-color); border-radius: 4px; /* Removed border for cleaner look */ }
        .hourly-forecast-container::-webkit-scrollbar-thumb:hover { background-color: var(--primary-color); }
        
        .hourly-card {
            display: flex; /* Changed from inline-flex for consistency */
            flex-direction: column;
            align-items: center;
            justify-content: center; 
            min-width: 90px; /* Adjusted */
            padding: var(--padding-sm);
            background-color: transparent; /* Cards transparent on container bg */
            border-radius: var(--border-radius-md);
            text-align: center;
            opacity: 0;
            transform: scale(0.95); /* Slightly different animation */
            transition: opacity 0.3s ease-out, transform 0.3s ease-out; /* Removed box-shadow transition as it has no shadow now */
        }
        .hourly-card.visible { opacity: 1; transform: scale(1); }
        .hourly-card:hover { 
            /* No hover effect needed if cards are transparent, or add a subtle one like slight scale */
            /* transform: scale(1.03); */
        }
        .hourly-card .time { font-size: 0.8rem; font-weight: 500; color: var(--text-muted-base); margin-bottom: 5px; }
        .hourly-card img.condition-icon { width: 38px; height: 38px; margin-bottom: 5px; }
        .hourly-card .temp { font-size: 1.05rem; font-weight: 600; color: var(--text-color-base); }
        .hourly-card .chance-of-rain { font-size: 0.7rem; color: var(--text-muted-base); margin-top: 4px; }
        .hourly-loader-placeholder { min-height: 120px; display:flex; align-items:center; justify-content:center; width:100%;}


        /* Forecast Section (10-day) */
        #forecastHeader { /* Target the h2 for 10-day forecast specifically */
             margin-top: var(--padding-xl);
        }
        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
            gap: var(--padding-md);
        }
        .forecast-card { 
            background-color: var(--surface-color);
            padding: var(--padding-md);
            border-radius: var(--border-radius-lg);
            text-align: center;
            box-shadow: 0 5px 15px rgba(44, 62, 80, 0.08);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            opacity: 0;
            transform: translateY(15px); /* Adjusted from 20px */
            transition: opacity 0.4s ease-out, transform 0.4s ease-out, box-shadow 0.2s ease; /* Added box-shadow to general transition */
        }
        .forecast-card.visible { 
            opacity: 1;
            transform: translateY(0);
        }
        .forecast-card:hover {
            transform: translateY(-4px); /* Adjusted hover effect */
            box-shadow: 0 8px 20px rgba(44, 62, 80, 0.12); /* Adjusted hover shadow */
        }
        .forecast-card .date { 
            font-size: 0.9rem; /* Adjusted */
            font-weight: 600;
            color: var(--text-color-base);
            margin-bottom: var(--padding-xs);
        }
        .forecast-card img.forecast-icon {
            width: 45px;
            height: 45px;
            margin: var(--padding-xs) auto;
            transition: transform 0.3s ease;
        }
        .forecast-card:hover img.forecast-icon { 
             transform: scale(1.1);
        }
        .forecast-card .temperature {
            font-size: 1.3rem; /* Adjusted */
            font-weight: bold;
            color: var(--primary-color);
            margin: var(--padding-xs) 0;
        }
        .forecast-card .condition {
            font-size: 0.8rem;
            color: var(--text-muted-base);
            text-transform: capitalize;
            margin-bottom: var(--padding-xs);
            flex-grow: 1;
        }
        .forecast-card .min-max {
            font-size: 0.75rem;
            color: var(--text-muted-base);
        }

        /* Status Messages */
        .status-message-container {
            padding: var(--padding-lg) 0; /* Adjusted from xl */
            text-align: center;
            display: none; 
        }
        .error-message { /* Only for critical error display */
            color: #e74c3c;
            background-color: #fdedec;
            border: 1px solid #f5c6cb;
            padding: var(--padding-md); /* Adjusted */
            border-radius: var(--border-radius-md);
            display: inline-block; /* To center it if container has text-align:center */
        }

        /* Footer */
        footer {
            background-color: var(--dark-color);
            color: #ccc; 
            padding: var(--padding-lg) 0 var(--padding-md); /* Adjusted */
            margin-top: var(--padding-xl);
            text-align: center;
        }
        .footer-bottom p { font-size: 0.9rem; } /* Simplified footer */
        .footer-bottom a { color: var(--accent-color); text-decoration: none; }
        .footer-bottom a:hover { text-decoration: underline; }
        .footer-content { display: none; } /* Hiding multi-column footer for simplicity */


        /* Responsive Adjustments */
        @media (max-width: 992px) {
            .forecast-grid { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); }
            .hourly-card { min-width: 85px; } 
        }
        @media (max-width: 768px) {
            .container { padding: 0 var(--padding-sm); }
            header { padding: var(--padding-xs) 0;}
            .header-container { height: 56px; } 
            .logo {font-size: 22px;} .logo i {font-size:24px;}
            nav ul li {margin-left: 15px;} nav ul li:last-child {margin-left: 10px;}
            .hero { padding: 120px var(--padding-sm) 60px; margin-top: 56px;}
            .hero h1 { font-size: 2.2rem; } .hero p.tagline { font-size: 1rem; }
            .search-form-container { max-width: 100%; }
            #currentWeatherCard { grid-template-columns: 1fr; text-align: center; gap: var(--padding-md); }
            #currentWeatherCard .weather-icon-temp { flex-direction: column; gap: var(--padding-xs); margin-bottom: var(--padding-md);}
            .section-title h2 { font-size: 1.6rem; } .section-subtitle { font-size: 1.3rem; }
            .forecast-grid { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: var(--padding-sm);}
            .hourly-card { min-width: 80px; }
        }
        @media (max-width: 480px) {
            .unit-toggle-btn { padding: 4px 8px; font-size: 0.8rem; min-width: 40px;}
            .hero { padding: 100px var(--padding-xs) 40px; margin-top: 56px; }
            .hero h1 { font-size: 1.8rem; }
            .search-form-wrapper { width: 95%; } 
            .search-form-container { flex-direction: column; border-radius: var(--border-radius-lg); max-width: none; }
            #locationInput { border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0; text-align: center; padding: 12px 15px; border-right: 1px solid var(--border-color); }
            #searchButton { border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg); justify-content: center; padding: 12px 15px;}
            .geolocation-btn { font-size: 0.85rem; padding: 8px 15px; }
            .search-input-error { font-size: 0.8rem; }
            #currentWeatherCard { gap: var(--padding-sm); padding: var(--padding-md); }
            .current-details-grid { grid-template-columns: 1fr; gap: var(--padding-xs); } 
            .current-details-grid p { padding: var(--padding-xs); font-size: 0.85rem;}
            #currentWeatherCard .current-temperature { font-size: 2.5rem;}
            #currentWeatherCard .current-condition { font-size: 1rem;}
            #currentWeatherCard img.current-icon { width: 70px; height: 70px;}
            .forecast-grid { grid-template-columns: 1fr; } 
            .hourly-card { min-width: 70px; padding: var(--padding-xs); } /* Further reduce hourly card size */
            .hourly-card .temp { font-size: 0.9rem;} .hourly-card img.condition-icon { width: 30px; height: 30px;}
        }

        /* css/styles.css END */
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <div class="logo"><i class="fas fa-cloud-sun"></i> WeatherWise</div>
            <nav>
                <ul>
                    <li><a href="#hero-section-target">Search</a></li>
                    <li><a href="#weather-results-target">Forecast</a></li>
                    <li><button id="unitToggleBtn" class="unit-toggle-btn" title="Switch temperature unit">°C</button></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="hero" id="hero-section-target">
            <div class="hero-content">
                <h1>Real-Time Weather</h1> <!-- Updated Tagline -->
                <p class="tagline">Instant updates for any city worldwide.</p>
                <div class="search-form-wrapper">
                    <div class="search-form-container">
                        <input type="text" id="locationInput" placeholder="Enter city name">
                        <button id="searchButton"><i class="fas fa-search"></i> Search</button>
                    </div>
                    <div id="searchInputError" class="search-input-error"></div> 
                    <button id="geolocationBtn" class="geolocation-btn">
                        <i class="fas fa-map-marker-alt"></i> Use My Location
                    </button>
                </div>
            </div>
        </section>

        <section class="weather-results-area" id="weather-results-target">
            <div class="container">
                <div id="locationHeader" class="section-title"></div> <!-- JS will inject <h2> here -->
                <article id="currentWeatherCard"></article>
                <section id="hourlyForecastSection" class="hourly-forecast-section">
                    <h3 class="section-subtitle" id="hourlyForecastTitle">Today's Hourly View</h3>
                    <div id="hourlyForecastContainer" class="hourly-forecast-container">
                         <div class="loader-container hourly-loader-placeholder"><div class="loader"></div></div>
                    </div>
                </section>
                <div class="section-title"> 
                    <h2 id="forecastHeader">10-Day Forecast</h2>
                </div>
                <div id="forecastGrid" class="forecast-grid"></div>
            </div>
        </section>
        <div id="statusMessageContainer" class="status-message-container container"></div>
    </main>

    <footer>
        <div class="container footer-bottom"> 
            <p>© <span id="currentYear"></span> WeatherWise. Powered by <a href="https://www.weatherapi.com/" target="_blank" rel="noopener noreferrer">WeatherAPI.com</a>.</p>
        </div>
    </footer>

    <script>
        // js/main.js START
        const API_KEY = 'a3af77f2f03f42cbbe335101250306';
        const DEFAULT_LOCATION = 'Yeovil';
        const FORECAST_DAYS = 10;

        const heroSection = document.querySelector('.hero');
        const locationInput = document.getElementById('locationInput');
        const searchButton = document.getElementById('searchButton');
        const searchInputError = document.getElementById('searchInputError');
        const unitToggleBtn = document.getElementById('unitToggleBtn');
        const geolocationBtn = document.getElementById('geolocationBtn');
        const weatherResultsArea = document.querySelector('.weather-results-area');
        const locationHeaderElement = document.getElementById('locationHeader');
        const forecastHeaderElement = document.getElementById('forecastHeader');
        const currentWeatherCard = document.getElementById('currentWeatherCard');
        const hourlyForecastContainer = document.getElementById('hourlyForecastContainer');
        const forecastGrid = document.getElementById('forecastGrid');
        const statusMessageContainer = document.getElementById('statusMessageContainer');
        const currentYearSpan = document.getElementById('currentYear');

        let searchErrorTimeoutId = null;
        let lastSuccessfulWeatherData = null;
        let currentUnit = 'celsius';

        function initializeApp() {
            if (currentYearSpan) currentYearSpan.textContent = new Date().getFullYear();
            loadPreferredUnit();
            addEventListeners();
            fetchWeatherData(DEFAULT_LOCATION, true);
        }

        function addEventListeners() {
            if(searchButton) searchButton.addEventListener('click', handleSearch);
            if(locationInput) {
                locationInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleSearch(); });
                locationInput.addEventListener('input', clearSearchInputError);
            }
            if(unitToggleBtn) unitToggleBtn.addEventListener('click', toggleUnit);
            if(geolocationBtn) geolocationBtn.addEventListener('click', handleGeolocation);
            
            window.addEventListener('scroll', () => requestAnimationFrame(handleParallax));
            handleParallax(); 
        }
        
        function clearSearchInputError() {
            if (searchInputError && searchInputError.classList.contains('visible')) {
                searchInputError.classList.remove('visible');
                if (searchErrorTimeoutId) clearTimeout(searchErrorTimeoutId);
            }
        }

        function handleParallax() {
            if (heroSection) heroSection.style.backgroundPositionY = window.pageYOffset * 0.35 + 'px';
        }

        function loadPreferredUnit() {
            currentUnit = localStorage.getItem('weatherAppUnit') === 'fahrenheit' ? 'fahrenheit' : 'celsius';
            updateUnitToggleUI();
        }
        function toggleUnit() {
            currentUnit = currentUnit === 'celsius' ? 'fahrenheit' : 'celsius';
            localStorage.setItem('weatherAppUnit', currentUnit);
            updateUnitToggleUI();
            if (lastSuccessfulWeatherData) displayAllWeatherData(lastSuccessfulWeatherData);
        }
        function updateUnitToggleUI() {
            if(unitToggleBtn) unitToggleBtn.textContent = currentUnit === 'celsius' ? '°C' : '°F';
        }
        function getTemp(c, f) {
            if (currentUnit === 'fahrenheit') return f !== undefined ? `${Math.round(f)}°F` : (c !== undefined ? `${Math.round(c * 9/5 + 32)}°F` : 'N/A');
            return c !== undefined ? `${Math.round(c)}°C` : (f !== undefined ? `${Math.round((f - 32) * 5/9)}°C` : 'N/A');
        }

        async function handleGeolocation() { 
            if (!navigator.geolocation) { showTemporaryError("Geolocation not supported.", 3000); return; }
            if (!geolocationBtn) return;

            geolocationBtn.disabled = true;
            geolocationBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Finding...';
            clearSearchInputError();
            try {
                const position = await new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject, { enableHighAccuracy: true, timeout: 20000, maximumAge: 0 });
                });
                if(locationInput) locationInput.value = ''; 
                await fetchWeatherData(`${position.coords.latitude},${position.coords.longitude}`);
            } catch (error) {
                let msg = "Location Error: ";
                if (error && error.code) {
                    switch (error.code) {
                        case error.PERMISSION_DENIED: msg += "Permission denied."; break;
                        case error.POSITION_UNAVAILABLE: msg += "Location unavailable."; break;
                        case error.TIMEOUT: msg += "Request timed out."; break;
                        default: msg += "Unknown error."; break;
                    }
                } else { msg += (error && error.message) ? error.message : "Unknown."}
                showTemporaryError(msg, 4000);
                console.error("Geolocation Error:", error);
            } finally {
                if(geolocationBtn){
                    geolocationBtn.disabled = false;
                    geolocationBtn.innerHTML = '<i class="fas fa-map-marker-alt"></i> Use My Location';
                }
            }
        }
        
        function showTemporaryError(message, duration = 2000) {
            if(!searchInputError) return;
            searchInputError.textContent = message;
            searchInputError.classList.add('visible');
            if (searchErrorTimeoutId) clearTimeout(searchErrorTimeoutId);
            searchErrorTimeoutId = setTimeout(() => searchInputError.classList.remove('visible'), duration);
        }

        function showCriticalError(message) {
            if(statusMessageContainer) {
                statusMessageContainer.innerHTML = `<p class="error-message">${message}</p>`;
                statusMessageContainer.style.display = 'block';
            }
            if(weatherResultsArea) weatherResultsArea.classList.remove('visible');
            lastSuccessfulWeatherData = null;
        }

        function showLoadingState(locationName, isPreservingContent = false) {
            if(statusMessageContainer) statusMessageContainer.style.display = 'none';
            clearSearchInputError();
            const loaderHTML = '<div class="loader-container"><div class="loader"></div></div>';
            
            if (!isPreservingContent && weatherResultsArea && !weatherResultsArea.classList.contains('visible')) {
                 requestAnimationFrame(() => setTimeout(() => {if(weatherResultsArea) weatherResultsArea.classList.add('visible');}, 50));
            }
            
            if(locationHeaderElement) locationHeaderElement.innerHTML = `<h2>Loading for ${locationName}...</h2>`;
            if (!isPreservingContent) {
                if(currentWeatherCard) {currentWeatherCard.classList.remove('content-visible'); currentWeatherCard.innerHTML = loaderHTML;}
                if(forecastGrid) forecastGrid.innerHTML = loaderHTML;
            }
            if(hourlyForecastContainer) hourlyForecastContainer.innerHTML = '<div class="loader-container hourly-loader-placeholder"><div class="loader"></div></div>';
        }
        
        function displayAllWeatherData(data) {
            if(!data) { showCriticalError("No weather data to display."); return; }
            displayCurrentWeather(data);
            displayHourlyForecast(data);
            display10DayForecast(data);
        }

        function displayCurrentWeather(data) {
            const { location, current } = data;
            if (!currentWeatherCard || !location || !current || !current.condition) { 
                if(currentWeatherCard) currentWeatherCard.innerHTML = '<p class="error-message" style="padding:1em;">Current data unavailable.</p>'; 
                if(locationHeaderElement && location) locationHeaderElement.innerHTML = `<h2>Weather for ${location.name || 'N/A'}</h2>`;
                else if(locationHeaderElement) locationHeaderElement.innerHTML = `<h2>Current Weather</h2>`;
                return; 
            }
            locationHeaderElement.innerHTML = `<h2>Weather in ${location.name}, ${location.country}</h2>`;
            let icon = current.condition.icon.startsWith('//') ? 'https:' + current.condition.icon : current.condition.icon;
            currentWeatherCard.innerHTML = `
                <div class="weather-icon-temp">
                    <img src="${icon}" alt="${current.condition.text}" class="current-icon">
                    <div class="temp-condition-stack">
                        <p class="current-temperature">${getTemp(current.temp_c, current.temp_f)}</p>
                        <p class="current-condition">${current.condition.text}</p>
                    </div>
                </div>
                <div class="current-details-grid">
                    <p><strong>Feels like:</strong> ${getTemp(current.feelslike_c, current.feelslike_f)}</p>
                    <p><strong>Humidity:</strong> ${current.humidity}%</p>
                    <p><strong>Wind:</strong> ${current.wind_kph} kph ${current.wind_dir}</p>
                    <p><strong>Pressure:</strong> ${current.pressure_mb} mb</p>
                    <p><strong>Visibility:</strong> ${current.vis_km} km</p><p><strong>UV Index:</strong> ${current.uv}</p>
                    <p><strong>Precipitation:</strong> ${current.precip_mm} mm</p>
                    <p><strong>Last Updated:</strong> ${current.last_updated ? current.last_updated.split(" ")[1] : 'N/A'}</p> 
                </div>`;
            currentWeatherCard.classList.remove('content-visible');
            requestAnimationFrame(() => setTimeout(() => {if(currentWeatherCard) currentWeatherCard.classList.add('content-visible');}, 50));
        }

        function displayHourlyForecast(data) {
            if (!hourlyForecastContainer || !data.forecast || !data.forecast.forecastday || !data.forecast.forecastday[0] || !data.forecast.forecastday[0].hour) {
                 if(hourlyForecastContainer) hourlyForecastContainer.innerHTML = '<p style="padding:0 var(--padding-sm);">Hourly data not available.</p>'; return; 
            }
            const hourlyData = data.forecast.forecastday[0].hour;
            hourlyForecastContainer.innerHTML = ''; 
            const now = new Date();
            const relevantHours = hourlyData.filter(h => new Date(h.time_epoch * 1000) >= now);
            
            if (relevantHours.length === 0) { hourlyForecastContainer.innerHTML = '<p style="padding:0 var(--padding-sm);">No more hourly data for today.</p>'; return; }

            relevantHours.slice(0, 12).forEach((hour, index) => { 
                 if (!hour.condition) return;
                let icon = hour.condition.icon.startsWith('//') ? 'https:' + hour.condition.icon : hour.condition.icon;
                const card = document.createElement('div'); card.className = 'hourly-card';
                card.innerHTML = `
                    <p class="time">${new Date(hour.time_epoch * 1000).toLocaleTimeString('en-GB', { hour: '2-digit', minute:'2-digit', hour12:false })}</p>
                    <img src="${icon}" alt="${hour.condition.text}" class="condition-icon">
                    <p class="temp">${getTemp(hour.temp_c, hour.temp_f)}</p>
                    ${hour.chance_of_rain > 0 ? `<p class="chance-of-rain">${hour.chance_of_rain}%</p>` : ''}`;
                hourlyForecastContainer.appendChild(card);
                requestAnimationFrame(() => setTimeout(() => card.classList.add('visible'), index * 60));
            });
        }

        function display10DayForecast(data) {
            if (!forecastGrid || !forecastHeaderElement || !data.forecast || !data.forecast.forecastday) {
                if(forecastGrid) forecastGrid.innerHTML = '<p class="error-message" style="grid-column:1/-1">Forecast data unavailable.</p>'; return;
            }
            const forecastDays = data.forecast.forecastday;
            forecastGrid.innerHTML = '';
            forecastHeaderElement.textContent = `${FORECAST_DAYS}-Day Forecast`;
            if (forecastDays.length === 0) { forecastGrid.innerHTML = '<p class="error-message" style="grid-column:1/-1">Forecast data unavailable.</p>'; return; }
            forecastDays.forEach((dayData, index) => {
                if (!dayData.day || !dayData.day.condition) return;
                let icon = dayData.day.condition.icon.startsWith('//') ? 'https:' + dayData.day.condition.icon : dayData.day.condition.icon;
                const card = document.createElement('div'); card.className = 'forecast-card';
                card.innerHTML = `
                    <p class="date">${new Date(dayData.date_epoch * 1000).toLocaleDateString('en-GB', { weekday: 'short', day: 'numeric', month: 'short'})}</p>
                    <img src="${icon}" alt="${dayData.day.condition.text}" class="forecast-icon">
                    <p class="temperature">${getTemp(dayData.day.avgtemp_c, dayData.day.avgtemp_f)}</p>
                    <p class="condition">${dayData.day.condition.text}</p>
                    <p class="min-max">Min: ${getTemp(dayData.day.mintemp_c, dayData.day.mintemp_f)} / Max: ${getTemp(dayData.day.maxtemp_c, dayData.day.maxtemp_f)}</p>`;
                forecastGrid.appendChild(card);
                requestAnimationFrame(() => setTimeout(() => card.classList.add('visible'), index * 80));
            });
        }
        
        function handleSearch() {
            const query = locationInput.value.trim();
            if (query) fetchWeatherData(query);
            else showTemporaryError("Please enter a city name.");
        }

        async function fetchWeatherData(locationQuery, isInitialLoad = false) {
            const preserveContent = !isInitialLoad && 
                                    lastSuccessfulWeatherData && 
                                    locationHeaderElement.textContent.includes(lastSuccessfulWeatherData.location.name); // Simpler check

            if (preserveContent) { 
                showLoadingState(locationQuery, true); 
            } else {
                if (weatherResultsArea.classList.contains('visible') && !isInitialLoad) {
                    weatherResultsArea.classList.remove('visible');
                    await new Promise(resolve => setTimeout(resolve, 350)); 
                } else if (weatherResultsArea) { 
                    weatherResultsArea.classList.remove('visible');
                }
                showLoadingState(locationQuery, false); 
            }

            const apiUrl = `https://api.weatherapi.com/v1/forecast.json?q=${encodeURIComponent(locationQuery)}&days=${FORECAST_DAYS}&key=${API_KEY}`;
            console.log(`Fetching: ${apiUrl}`); // Log API URL

            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                console.log("API Response Data:", data); // Log full API response

                if (data.error) {
                    if (data.error.code === 1006) { 
                        showTemporaryError(`No location: "${locationQuery}". Try again.`, 3000);
                        if (lastSuccessfulWeatherData && !isInitialLoad) {
                            displayAllWeatherData(lastSuccessfulWeatherData); 
                        } else if (isInitialLoad) { 
                            showCriticalError(`Default location error: ${data.error.message}`);
                        } else { 
                             if(locationHeaderElement) locationHeaderElement.innerHTML = `<h2>"${locationQuery}" not found</h2>`;
                             if(currentWeatherCard) currentWeatherCard.innerHTML = ''; 
                             if(hourlyForecastContainer) hourlyForecastContainer.innerHTML = ''; 
                             if(forecastGrid) forecastGrid.innerHTML = '';
                        }
                    } else { throw new Error(`API Error (${data.error.code}): ${data.error.message}`); }
                    return; 
                }
                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);

                lastSuccessfulWeatherData = data; 
                if(statusMessageContainer) statusMessageContainer.style.display = 'none'; 
                
                if (preserveContent) { 
                    if (currentWeatherCard) { currentWeatherCard.classList.remove('content-visible'); currentWeatherCard.innerHTML = '<div class="loader-container"><div class="loader"></div></div>';}
                    if (forecastGrid) { forecastGrid.innerHTML = '<div class="loader-container"><div class="loader"></div></div>'; }
                    if (hourlyForecastContainer) { hourlyForecastContainer.innerHTML = '<div class="loader-container hourly-loader-placeholder"><div class="loader"></div></div>'; }
                    await new Promise(resolve => setTimeout(resolve, 50)); 
                }

                displayAllWeatherData(data);
                
                if (weatherResultsArea && !weatherResultsArea.classList.contains('visible')) {
                    requestAnimationFrame(() => setTimeout(() => {if(weatherResultsArea) weatherResultsArea.classList.add('visible');}, 50));
                }
                if (!isInitialLoad && locationQuery.toLowerCase() !== DEFAULT_LOCATION.toLowerCase() && !locationQuery.includes(',')) { 
                     setTimeout(() => document.getElementById('weather-results-target')?.scrollIntoView({behavior: "smooth", block: "start"}), 200);
                }

            } catch (error) {
                console.error("Fetch Weather Error:", error);
                showCriticalError(`Failed to fetch weather. ${error.message}. Check console.`);
            } finally {
                 if (geolocationBtn && geolocationBtn.disabled) {
                    geolocationBtn.disabled = false;
                    geolocationBtn.innerHTML = '<i class="fas fa-map-marker-alt"></i> Use My Location';
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', initializeApp);
        // js/main.js END
    </script>
</body>
</html>